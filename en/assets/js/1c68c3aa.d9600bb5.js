"use strict";(self.webpackChunkdocs_site=self.webpackChunkdocs_site||[]).push([[8841],{2576:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"bella-queue/api/queue/take","title":"Get Task","description":"POST http(s)://{}/v1/queue/take","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/bella-queue/api/queue/take.md","sourceDirName":"bella-queue/api/queue","slug":"/bella-queue/api/queue/take","permalink":"/en/docs/bella-queue/api/queue/take","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"documentationSidebar","previous":{"title":"Submit Task","permalink":"/en/docs/bella-queue/api/queue/put"},"next":{"title":"Complete Task","permalink":"/en/docs/bella-queue/api/queue/complete"}}');var i=s(4848),r=s(8453);const l={},a="Get Task",d={},c=[{value:"Examples",id:"examples",level:2},{value:"Offline Task Example",id:"offline-task-example",level:3},{value:"Online Task Example",id:"online-task-example",level:3},{value:"Request Body Parameters",id:"request-body-parameters",level:2},{value:"Queue Strategies",id:"queue-strategies",level:2},{value:"fifo strategy",id:"fifo-strategy",level:3},{value:"round_robin strategy",id:"round_robin-strategy",level:3},{value:"active_passive strategy",id:"active_passive-strategy",level:3},{value:"sequential strategy",id:"sequential-strategy",level:3},{value:"Returns",id:"returns",level:2},{value:"Field Differences",id:"field-differences",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"get-task",children:"Get Task"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"POST"})," ",(0,i.jsx)(n.code,{children:"http(s)://{{Host}}/v1/queue/take"})]}),"\n",(0,i.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(n.h3,{id:"offline-task-example",children:"Offline Task Example"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST "https://${Host}/v1/queue/take" \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer ${apikey}" \\\n  -d \'{\n    "queues": [\n        "test-queue:1"\n    ],\n    "strategy": "active_passive",\n    "endpoint": "/v1/chat/completions",\n    "size": 1\n}\'\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response (Offline task with batch_id and trace_id)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "test-queue:1": [\n    {\n      "ak": "xxx",\n      "endpoint": "/v1/chat/completions",\n      "queue": "test-queue",\n      "level": 1,\n      "data": {\n        "k": "v"\n      },\n      "status": "waiting",\n      "task_id": "TASK-X-X-X-XXXXXXXXXXXX-XXXX-XXXXXX",\n      "batch_id": "BATCH-X-X-XXXXXXXXXXXX-XXXX-XXXXXX",\n      "trace_id": "BATCH-X-X-XXXXXXXXXXXX-XXXX-XXXXXX",\n      "start_time": 1762863595000,\n      "running_time": 0,\n      "expire_time": 1762949994000,\n      "completed_time": 0,\n      "callback_url": "",\n      "response_mode": "batch"\n    }\n  ]\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"online-task-example",children:"Online Task Example"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST "https://${Host}/v1/queue/take" \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer ${apikey}" \\\n  -d \'{\n    "queues": [\n        "test-queue:0"\n    ],\n    "strategy": "fifo",\n    "endpoint": "/v1/chat/completions",\n    "size": 1\n}\'\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response (Online task with instance_id)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "test-queue:0": [\n    {\n      "ak": "xxx",\n      "endpoint": "/v1/chat/completions",\n      "queue": "test-queue",\n      "level": 0,\n      "data": {\n        "model": "deepseek-r1-20250401",\n        "messages": [\n          {\n            "role": "user",\n            "content": "Hello"\n          }\n        ],\n        "stream": false\n      },\n      "status": "waiting",\n      "task_id": "TASK-X-X-X-XXXXXXXXXXXX-XXXX-XXXXXX",\n      "instance_id": "xx.xx.xx.xx:xxx",\n      "start_time": 1762863595000,\n      "running_time": 0,\n      "expire_time": 1762949994000,\n      "completed_time": 0,\n      "callback_url": "",\n      "response_mode": "blocking"\n    }\n  ]\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"request-body-parameters",children:"Request Body Parameters"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Required"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"queues"})}),(0,i.jsx)(n.td,{children:"string[]"}),(0,i.jsx)(n.td,{children:"Required"}),(0,i.jsxs)(n.td,{children:['List of queue names to get tasks from (format: "queueName',":level",'")']})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"strategy"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Optional"}),(0,i.jsx)(n.td,{children:"Queue strategy: fifo, round_robin, active_passive, sequential, default fifo"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"endpoint"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Optional"}),(0,i.jsx)(n.td,{children:"Capability endpoint for processing tasks"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"size"})}),(0,i.jsx)(n.td,{children:"integer"}),(0,i.jsx)(n.td,{children:"Required"}),(0,i.jsx)(n.td,{children:"Number of tasks to get"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"queue-strategies",children:"Queue Strategies"}),"\n",(0,i.jsx)(n.h3,{id:"fifo-strategy",children:"fifo strategy"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logic"}),": First-In-First-Out"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Behavior"}),": Process tasks in order of submission time, earliest submitted tasks are taken first"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use case"}),": Scenarios requiring strict chronological order processing"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"round_robin-strategy",children:"round_robin strategy"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logic"}),": Round-robin scheduling, taking tasks from multiple queues in turn"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Behavior"}),": Take tasks from each queue in sequence, achieving load balancing"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use case"}),": Scenarios where multiple queues need evenly distributed processing resources"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"active_passive-strategy",children:"active_passive strategy"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logic"}),": Primary-backup mode, prioritize processing primary queue tasks"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Behavior"}),": Prioritize getting tasks from the first queue (primary queue), only get from backup queues when primary queue is empty"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use case"}),": Scenarios with priority distinction, high-priority queues processed first"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"sequential-strategy",children:"sequential strategy"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logic"}),": Global sequential execution, ensuring each queue can only have one task running at a time, only one task per queue"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Behavior"}),": Skip queues with running tasks, get the earliest task from other queues in order, set running lock to prevent concurrent execution"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use case"}),": Scenarios requiring strict sequential execution, avoiding race conditions caused by concurrent tasks in the same queue"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"returns",children:"Returns"}),"\n",(0,i.jsxs)(n.p,{children:["Response format: ",(0,i.jsx)(n.code,{children:"{queueName: [taskArray]}"})]}),"\n",(0,i.jsx)(n.h3,{id:"field-differences",children:"Field Differences"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Online Tasks (level=0)"}),": Contains ",(0,i.jsx)(n.code,{children:"instance_id"})," field for real-time task processing and event bus communication"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Offline Tasks (level=1)"}),": Contains ",(0,i.jsx)(n.code,{children:"batch_id"})," and ",(0,i.jsx)(n.code,{children:"trace_id"})," fields for batch processing tracking and management"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var t=s(6540);const i={},r=t.createContext(i);function l(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);