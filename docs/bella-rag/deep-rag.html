<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-bella-rag/deep-rag" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Deep RAG - 智能Agent模式 | Bella Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://doc.bella.top/img/bella-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://doc.bella.top/img/bella-social-card.jpg"><meta data-rh="true" property="og:url" content="https://doc.bella.top/docs/bella-rag/deep-rag"><meta data-rh="true" property="og:locale" content="zh_CN"><meta data-rh="true" property="og:locale:alternate" content="en_US"><meta data-rh="true" name="docusaurus_locale" content="zh-CN"><meta data-rh="true" name="docsearch:language" content="zh-CN"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deep RAG - 智能Agent模式 | Bella Documentation"><meta data-rh="true" name="description" content="Deep RAG是Bella-RAG系统的核心创新功能，基于Planning and Solve模式实现的智能agent，模拟人类在书架上查找答案的方式，提供比传统RAG更优的问答效果。"><meta data-rh="true" property="og:description" content="Deep RAG是Bella-RAG系统的核心创新功能，基于Planning and Solve模式实现的智能agent，模拟人类在书架上查找答案的方式，提供比传统RAG更优的问答效果。"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://doc.bella.top/docs/bella-rag/deep-rag"><link data-rh="true" rel="alternate" href="https://doc.bella.top/docs/bella-rag/deep-rag" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://doc.bella.top/en/docs/bella-rag/deep-rag" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://doc.bella.top/docs/bella-rag/deep-rag" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Deep RAG - 智能Agent模式","item":"https://doc.bella.top/docs/bella-rag/deep-rag"}]}</script><link rel="stylesheet" href="/assets/css/styles.c464aa75.css">
<script src="/assets/js/runtime~main.482cf9bc.js" defer="defer"></script>
<script src="/assets/js/main.9686989c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Bella Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Bella Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Bella Opensource</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">文档</a><a class="navbar__item navbar__link" href="/api-viewer">API</a><a href="https://wiki.bella.top" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">DeepWiki<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item"><div id="github-star-button"></div></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文 (简体)</a><ul class="dropdown__menu"><li><a href="/docs/bella-rag/deep-rag" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-CN">中文 (简体)</a></li><li><a href="/en/docs/bella-rag/deep-rag" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-US">English</a></li></ul></div><a href="https://github.com/LianjiaTech/bella-openapi" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro"><span title="介绍（Introduction）" class="linkLabel_WmDU">介绍（Introduction）</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/bella-openapi/intro"><span title="OpenAPI" class="categoryLinkLabel_W154">OpenAPI</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/bella-assistants/intro"><span title="assistant&amp;responses" class="categoryLinkLabel_W154">assistant&amp;responses</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/bella-rag/intro"><span title="RAG" class="categoryLinkLabel_W154">RAG</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bella-rag/intro"><span title="介绍（Introduction）" class="linkLabel_WmDU">介绍（Introduction）</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/bella-rag/usage"><span title="使用文档 (Usage Documents)" class="categoryLinkLabel_W154">使用文档 (Usage Documents)</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bella-rag/usage"><span title="RAG使用指南" class="linkLabel_WmDU">RAG使用指南</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/bella-rag/deep-rag"><span title="Deep RAG - 智能Agent模式" class="linkLabel_WmDU">Deep RAG - 智能Agent模式</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bella-rag/api"><span title="RAG API接口协议" class="linkLabel_WmDU">RAG API接口协议</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bella-rag/advanced"><span title="高级特性" class="linkLabel_WmDU">高级特性</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/bella-workflow/intro"><span title="Workflow" class="categoryLinkLabel_W154">Workflow</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/bella-domify/intro"><span title="Domify" class="categoryLinkLabel_W154">Domify</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/bella-knowledge/intro"><span title="Knowledge" class="categoryLinkLabel_W154">Knowledge</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/claude-code/introduction"><span title="Claude Code With Bella" class="categoryLinkLabel_W154">Claude Code With Bella</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">RAG</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">使用文档 (Usage Documents)</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Deep RAG - 智能Agent模式</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Deep RAG - 智能Agent模式</h1></header>
<p>Deep RAG是Bella-RAG系统的核心创新功能，基于Planning and Solve模式实现的智能agent，模拟人类在书架上查找答案的方式，提供比传统RAG更优的问答效果。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-什么是deep-rag">💡 什么是Deep RAG<a href="#-什么是deep-rag" class="hash-link" aria-label="💡 什么是Deep RAG的直接链接" title="💡 什么是Deep RAG的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="核心理念">核心理念<a href="#核心理念" class="hash-link" aria-label="核心理念的直接链接" title="核心理念的直接链接" translate="no">​</a></h3>
<p>随着大语言模型能力的不断提升和上下文窗口的扩大，我们设计了一种让模型模拟人在书架上查找答案的方式，实现deep search模式的RAG。
<img decoding="async" loading="lazy" alt="img.png" src="/assets/images/img-a06c8a6fa151086fd7d0124145e388f7.png" width="1778" height="396" class="img_ev3q"></p>
<p><strong>核心思路</strong>：</p>
<ol>
<li><strong>圈定文件范围</strong> - 像人类一样先确定可能包含答案的文档</li>
<li><strong>阅读文档内容</strong> - 深度阅读相关文档的完整内容</li>
<li><strong>反思验证</strong> - 对搜索和阅读结果进行反思验证</li>
<li><strong>动态调整</strong> - 根据执行结果动态调整后续计划</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="传统rag-vs-deep-rag">传统RAG vs Deep RAG<a href="#传统rag-vs-deep-rag" class="hash-link" aria-label="传统RAG vs Deep RAG的直接链接" title="传统RAG vs Deep RAG的直接链接" translate="no">​</a></h3>
<table><thead><tr><th>对比维度</th><th>传统RAG</th><th>Deep RAG</th></tr></thead><tbody><tr><td><strong>检索方式</strong></td><td>基于embedding的片段检索</td><td>基于文档级别的智能搜索</td></tr><tr><td><strong>内容理解</strong></td><td>依赖切片，可能破坏文档结构</td><td>阅读完整文档，保持原始结构</td></tr><tr><td><strong>推理能力</strong></td><td>单步检索生成</td><td>多步骤规划和执行</td></tr><tr><td><strong>准确率</strong></td><td>72%+</td><td>84%+（相比传统模式提升12pp）</td></tr><tr><td><strong>适用场景</strong></td><td>简单问答</td><td>复杂问题分析和推理</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-核心工具">🔧 核心工具<a href="#-核心工具" class="hash-link" aria-label="🔧 核心工具的直接链接" title="🔧 核心工具的直接链接" translate="no">​</a></h2>
<p>Deep RAG封装了两个核心工具来实现智能搜索：</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-file_search工具">1. file_search工具<a href="#1-file_search工具" class="hash-link" aria-label="1. file_search工具的直接链接" title="1. file_search工具的直接链接" translate="no">​</a></h3>
<ul>
<li><strong>功能</strong>: 根据用户提问查询相关文件列表</li>
<li><strong>实现方式</strong>: 结合文件摘要和检索技术，智能圈定相关文件范围</li>
<li><strong>优化</strong>: 支持分页查询，避免信息过载</li>
</ul>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;file_search&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;purpose&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;查询与用户提问相关的文件列表，并返回文件内与提问相关的内容片段，可翻页查询&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;input_schema&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;object&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;properties&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;question&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;string&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token property">&quot;description&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;用户提问&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;page&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;integer&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token property">&quot;description&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;分页检索序号（从1开始）&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-read_file工具">2. read_file工具<a href="#2-read_file工具" class="hash-link" aria-label="2. read_file工具的直接链接" title="2. read_file工具的直接链接" translate="no">​</a></h3>
<ul>
<li><strong>功能</strong>: 根据文件ID读取完整文档内容</li>
<li><strong>实现方式</strong>: 读取文件流并转换为模型友好的markdown格式</li>
<li><strong>优势</strong>: 保持文档原始结构，提供完整上下文</li>
</ul>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;read_file&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;purpose&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;读取指定文件的详细内容&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;input_schema&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;object&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;properties&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;file_id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;string&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token property">&quot;description&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;通过file_search获取的文件标识&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-planning-and-solve模式">🏗️ Planning and Solve模式<a href="#️-planning-and-solve模式" class="hash-link" aria-label="🏗️ Planning and Solve模式的直接链接" title="🏗️ Planning and Solve模式的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="架构优势">架构优势<a href="#架构优势" class="hash-link" aria-label="架构优势的直接链接" title="架构优势的直接链接" translate="no">​</a></h3>
<p>Deep RAG采用Planning and Solve执行模式，具有以下优势：</p>
<ul>
<li><strong>灵活性强</strong>: re-planning机制可以满足react模式的查漏补缺，还可以跳过无用步骤，节省开销</li>
<li><strong>通用性</strong>: 整体planning prompt比较宏观，基本填入工具列表即可实现deep rag或者实现其他的agent</li>
<li><strong>效果</strong>: re-planning机制天然的实现了多重反思，适用复杂的任务</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="执行流程">执行流程<a href="#执行流程" class="hash-link" aria-label="执行流程的直接链接" title="执行流程的直接链接" translate="no">​</a></h3>
<p><img decoding="async" loading="lazy" alt="deep_pipline.png" src="/assets/images/deep_pipline-184fc093c9d5488fd7c4bc68ab606ede.png" width="1924" height="288" class="img_ev3q"></p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="五个核心阶段">五个核心阶段<a href="#五个核心阶段" class="hash-link" aria-label="五个核心阶段的直接链接" title="五个核心阶段的直接链接" translate="no">​</a></h3>
<ol>
<li>
<p><strong>plan(query) → plan</strong></p>
<ul>
<li>指定一个初始的执行计划，根据当前装载的工具及用户提问</li>
</ul>
</li>
<li>
<p><strong>execute_plan(plan) → plan, steps</strong></p>
<ul>
<li>按照计划及用户的提问准备工具参数，执行当前依赖已完成的计划</li>
<li>执行结果加载到memory</li>
</ul>
</li>
<li>
<p><strong>replan(plan, query, steps) → plan</strong></p>
<ul>
<li>重新制定计划</li>
<li>如果当前执行完已经能回答了，后续计划可以标记跳过</li>
<li>如果当前计划不满足要求，继续视情况添加步骤</li>
</ul>
</li>
<li>
<p><strong>plan_review(old_plan, new_plan) → bool</strong></p>
<ul>
<li>如果所有计划执行完成，则任务结束</li>
</ul>
</li>
<li>
<p><strong>conclusion(plan, memory) → str</strong></p>
<ul>
<li>根据执行步骤和memory生成回答</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-优化机制">🚀 优化机制<a href="#-优化机制" class="hash-link" aria-label="🚀 优化机制的直接链接" title="🚀 优化机制的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="反思机制reflection">反思机制（Reflection）<a href="#反思机制reflection" class="hash-link" aria-label="反思机制（Reflection）的直接链接" title="反思机制（Reflection）的直接链接" translate="no">​</a></h3>
<p>为了提高执行准确性，Deep RAG引入了反思机制：</p>
<ul>
<li><strong>文件搜索反思</strong>: 从search到的相关文件里，由语义理解能力较强的模型，选取最接近的文件</li>
<li><strong>文件阅读反思</strong>: 对文档的读取内容，由语义理解能力较强的模型判断是否相关</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-性能表现">📊 性能表现<a href="#-性能表现" class="hash-link" aria-label="📊 性能表现的直接链接" title="📊 性能表现的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="效果对比">效果对比<a href="#效果对比" class="hash-link" aria-label="效果对比的直接链接" title="效果对比的直接链接" translate="no">​</a></h3>
<p>基于实际测试数据，Deep RAG相比传统检索模式有显著提升：</p>
<table><thead><tr><th>指标</th><th>传统RAG</th><th>Deep RAG</th><th>提升幅度</th></tr></thead><tbody><tr><td><strong>回答准确率</strong></td><td>85%</td><td>97%</td><td>+12pp</td></tr><tr><td><strong>复杂问题处理</strong></td><td>良好</td><td>优秀</td><td>显著提升</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="适用场景">适用场景<a href="#适用场景" class="hash-link" aria-label="适用场景的直接链接" title="适用场景的直接链接" translate="no">​</a></h3>
<ul>
<li>✅ <strong>复杂问题分析</strong>: 需要多步骤推理的问题</li>
<li>✅ <strong>跨文档信息整合</strong>: 需要从多个文档中提取信息</li>
<li>✅ <strong>深度内容理解</strong>: 需要理解文档完整上下文</li>
<li>✅ <strong>专业领域问答</strong>: 需要准确理解专业术语和概念</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="注意事项">注意事项<a href="#注意事项" class="hash-link" aria-label="注意事项的直接链接" title="注意事项的直接链接" translate="no">​</a></h3>
<ul>
<li>⚠️ <strong>执行时间</strong>: 相比传统模式耗时更长，适合对准确性要求高的场景</li>
<li>⚠️ <strong>资源消耗</strong>: 需要更多的模型调用和计算资源</li>
<li>⚠️ <strong>模型依赖</strong>: 效果与底层大语言模型能力强相关</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-使用方法">🔗 使用方法<a href="#-使用方法" class="hash-link" aria-label="🔗 使用方法的直接链接" title="🔗 使用方法的直接链接" translate="no">​</a></h2>
<p>要使用Deep RAG模式，只需在API调用时设置mode参数：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--location</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;http://localhost:8008/api/rag/chat&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--header</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Authorization: Bearer {OPEN_API_KEY}&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--header</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Content-Type: application/json&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--data</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;query&quot;: &quot;复杂问题描述&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;scope&quot;: [{&quot;type&quot;: &quot;file&quot;, &quot;ids&quot;: [&quot;file_123&quot;]}],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;user&quot;: &quot;user_00000000&quot;, </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;response_type&quot;: &quot;stream&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">    &quot;mode&quot;: &quot;deep&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">  }&#x27;</span><br></span></code></pre></div></div>
<p>详细的API使用说明请参考<a href="/docs/bella-rag/api">API接口文档</a>。</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/bella-rag/usage"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">RAG使用指南</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/bella-rag/api"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">RAG API接口协议</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-什么是deep-rag" class="table-of-contents__link toc-highlight">💡 什么是Deep RAG</a><ul><li><a href="#核心理念" class="table-of-contents__link toc-highlight">核心理念</a></li><li><a href="#传统rag-vs-deep-rag" class="table-of-contents__link toc-highlight">传统RAG vs Deep RAG</a></li></ul></li><li><a href="#-核心工具" class="table-of-contents__link toc-highlight">🔧 核心工具</a><ul><li><a href="#1-file_search工具" class="table-of-contents__link toc-highlight">1. file_search工具</a></li><li><a href="#2-read_file工具" class="table-of-contents__link toc-highlight">2. read_file工具</a></li></ul></li><li><a href="#️-planning-and-solve模式" class="table-of-contents__link toc-highlight">🏗️ Planning and Solve模式</a><ul><li><a href="#架构优  势" class="table-of-contents__link toc-highlight">架构优势</a></li><li><a href="#执行流程" class="table-of-contents__link toc-highlight">执行流程</a></li><li><a href="#五个核心阶段" class="table-of-contents__link toc-highlight">五个核心阶段</a></li></ul></li><li><a href="#-优化机制" class="table-of-contents__link toc-highlight">🚀 优化机制</a><ul><li><a href="#反思机制reflection" class="table-of-contents__link toc-highlight">反思机制（Reflection）</a></li></ul></li><li><a href="#-性能表现" class="table-of-contents__link toc-highlight">📊 性能表现</a><ul><li><a href="#效果对比" class="table-of-contents__link toc-highlight">效果对比</a></li><li><a href="#适用场景" class="table-of-contents__link toc-highlight">适用场景</a></li><li><a href="#注意事项" class="table-of-contents__link toc-highlight">注意事项</a></li></ul></li><li><a href="#-使用方法" class="table-of-contents__link toc-highlight">🔗 使用方法</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">入门指南</a></li><li class="footer__item"><a class="footer__link-item" href="/api-viewer">API 文档</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/LianjiaTech/bella-openapi/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Issues<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/LianjiaTech/bella-openapi" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">版权所有 2025 LianjiaTech. 基于 Docusaurus 构建。</div></div></div></footer></div>
</body>
</html>